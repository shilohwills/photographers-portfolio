function _classCallCheck(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function _objectSpread2(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!e||r.length!==e);n=!0);}catch(l){o=!0,a=l}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return r}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray(t,e)}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function _nonIterableSpread(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _nonIterableRest(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function extend(t,e){return Object.getOwnPropertyNames(Object(t)).reduce(function(r,n){var o=Object.getOwnPropertyDescriptor(Object(t),n),a=Object.getOwnPropertyDescriptor(Object(e),n);return Object.defineProperty(r,n,a||o)},{})}function isString(t){return"string"==typeof t}function isArray(t){return Array.isArray(t)}function parseSettings(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=extend(e);return void 0!==r.types?t=r.types:void 0!==r.split&&(t=r.split),void 0!==t&&(r.types=(isString(t)||isArray(t)?String(t):"").split(",").map(function(t){return String(t).trim()}).filter(function(t){return/((line)|(word)|(char))/i.test(t)})),(r.absolute||r.position)&&(r.absolute=r.absolute||/absolute/.test(e.position)),r}function parseTypes(t){var e=isString(t)||isArray(t)?String(t):"";return{none:!e,lines:/line/i.test(e),words:/word/i.test(e),chars:/char/i.test(e)}}function isObject(t){return null!==t&&"object"==typeof t}function isNode(t){return isObject(t)&&/^(1|3|11)$/.test(t.nodeType)}function isLength(t){return"number"==typeof t&&t>-1&&t%1==0}function isArrayLike(t){return isObject(t)&&isLength(t.length)}function toArray(t){return isArray(t)?t:null==t?[]:isArrayLike(t)?Array.prototype.slice.call(t):[t]}function getTargetElements(t){var e=t;return isString(t)&&(e=/^(#[a-z]\w+)$/.test(t.trim())?document.getElementById(t.trim().slice(1)):document.querySelectorAll(t)),toArray(e).reduce(function(t,e){return[].concat(_toConsumableArray(t),_toConsumableArray(toArray(e).filter(isNode)))},[])}!function(){function t(){for(var t=arguments.length,e=0;e<t;e++){var r=e<0||arguments.length<=e?void 0:arguments[e];1===r.nodeType||11===r.nodeType?this.appendChild(r):this.appendChild(document.createTextNode(String(r)))}}function e(){for(;this.lastChild;)this.removeChild(this.lastChild);arguments.length&&this.append.apply(this,arguments)}function r(){for(var t=this.parentNode,e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];var o=r.length;if(t)for(o||t.removeChild(this);o--;){var a=r[o];"object"!=typeof a?a=this.ownerDocument.createTextNode(a):a.parentNode&&a.parentNode.removeChild(a),o?t.insertBefore(this.previousSibling,a):t.replaceChild(a,this)}}"undefined"==typeof Element||(Element.prototype.append||(Element.prototype.append=t,DocumentFragment.prototype.append=t),Element.prototype.replaceChildren||(Element.prototype.replaceChildren=e,DocumentFragment.prototype.replaceChildren=e),Element.prototype.replaceWith||(Element.prototype.replaceWith=r,DocumentFragment.prototype.replaceWith=r))}();var entries=Object.entries,expando="_splittype",cache={},uid=0;function set(t,e,r){if(!isObject(t))return console.warn("[data.set] owner is not an object"),null;var n=t[expando]||(t[expando]=++uid),o=cache[n]||(cache[n]={});return void 0===r?e&&Object.getPrototypeOf(e)===Object.prototype&&(cache[n]=_objectSpread2(_objectSpread2({},o),e)):void 0!==e&&(o[e]=r),r}function get(t,e){var r=isObject(t)?t[expando]:null,n=r&&cache[r]||{};return void 0===e?n:n[e]}function remove(t){var e=t&&t[expando];e&&(delete t[e],delete cache[e])}function clear(){Object.keys(cache).forEach(function(t){delete cache[t]})}function cleanup(){entries(cache).forEach(function(t){var e=_slicedToArray(t,2),r=e[0],n=e[1],o=n.isRoot,a=n.isSplit;o&&a||(cache[r]=null,delete cache[r])})}function toWords(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return(t?String(t):"").trim().replace(/\s+/g," ").split(e)}var rsAstralRange="\ud800-\udfff",rsComboMarksRange="\\u0300-\\u036f\\ufe20-\\ufe23",rsComboSymbolsRange="\\u20d0-\\u20f0",rsVarRange="\\ufe0e\\ufe0f",rsAstral="[".concat(rsAstralRange,"]"),rsCombo="[".concat(rsComboMarksRange).concat(rsComboSymbolsRange,"]"),rsFitz="\ud83c[\udffb-\udfff]",rsModifier="(?:".concat(rsCombo,"|").concat(rsFitz,")"),rsNonAstral="[^".concat(rsAstralRange,"]"),rsRegional="(?:\ud83c[\udde6-\uddff]){2}",rsSurrPair="[\ud800-\udbff][\udc00-\udfff]",rsZWJ="\\u200d",reOptMod="".concat(rsModifier,"?"),rsOptVar="[".concat(rsVarRange,"]?"),rsOptJoin="(?:"+rsZWJ+"(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")"+rsOptVar+reOptMod+")",rsSeq=rsOptVar+reOptMod+rsOptJoin,rsSymbol="(?:".concat(["".concat(rsNonAstral).concat(rsCombo,"?"),rsCombo,rsRegional,rsSurrPair,rsAstral].join("|"),"\n)"),reUnicode=RegExp("".concat(rsFitz,"(?=").concat(rsFitz,")|").concat(rsSymbol).concat(rsSeq),"g"),unicodeRange=[rsZWJ,rsAstralRange,rsComboMarksRange,rsComboSymbolsRange,rsVarRange],reHasUnicode=RegExp("[".concat(unicodeRange.join(""),"]"));function asciiToArray(t){return t.split("")}function hasUnicode(t){return reHasUnicode.test(t)}function unicodeToArray(t){return t.match(reUnicode)||[]}function stringToArray(t){return hasUnicode(t)?unicodeToArray(t):asciiToArray(t)}function toString(t){return null==t?"":String(t)}function toChars(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(t=toString(t))&&isString(t)&&!e&&hasUnicode(t)?stringToArray(t):t.split(e)}function createElement(t,e){var r=document.createElement(t);return e&&Object.keys(e).forEach(function(t){var n=e[t],o=isString(n)?n.trim():n;null!==o&&""!==o&&("children"===t?r.append.apply(r,_toConsumableArray(toArray(o))):r.setAttribute(t,o))}),r}var defaults={splitClass:"",lineClass:"line",wordClass:"word",charClass:"char",types:["lines","words","chars"],absolute:!1,tagName:"div"};function splitWordsAndChars(t,e){e=extend(defaults,e);var r=parseTypes(e.types),n=e.tagName,o=t.nodeValue,a=document.createDocumentFragment(),i=[],s=[];return/^\s/.test(o)&&a.append(" "),i=toWords(o).reduce(function(t,o,i,l){var c,u;return r.chars&&(u=toChars(o).map(function(t){var r=createElement(n,{class:"".concat(e.splitClass," ").concat(e.charClass),style:"display: inline-block;",children:t});return set(r,"isChar",!0),s=[].concat(_toConsumableArray(s),[r]),r})),r.words||r.lines?(c=createElement(n,{class:"".concat(e.wordClass," ").concat(e.splitClass),style:"display: inline-block; ".concat(r.words&&e.absolute?"position: relative;":""),children:r.chars?u:o}),set(c,{isWord:!0,isWordStart:!0,isWordEnd:!0}),a.appendChild(c)):u.forEach(function(t){a.appendChild(t)}),i<l.length-1&&a.append(" "),r.words?t.concat(c):t},[]),/\s$/.test(o)&&a.append(" "),t.replaceWith(a),{words:i,chars:s}}function split(t,e){var r=t.nodeType,n={words:[],chars:[]};if(!/(1|3|11)/.test(r))return n;if(3===r&&/\S/.test(t.nodeValue))return splitWordsAndChars(t,e);var o=toArray(t.childNodes);if(o.length&&(set(t,"isSplit",!0),!get(t).isRoot)){t.style.display="inline-block",t.style.position="relative";var a=t.nextSibling,i=t.previousSibling,s=t.textContent||"",l=a?a.textContent:" ",c=i?i.textContent:" ";set(t,{isWordEnd:/\s$/.test(s)||/^\s/.test(l),isWordStart:/^\s/.test(s)||/\s$/.test(c)})}return o.reduce(function(t,r){var n=split(r,e),o=n.words,a=n.chars;return{words:[].concat(_toConsumableArray(t.words),_toConsumableArray(o)),chars:[].concat(_toConsumableArray(t.chars),_toConsumableArray(a))}},n)}function getPosition(t,e,r,n){if(!r.absolute)return{top:e?t.offsetTop:null};var o=t.offsetParent,a=_slicedToArray(n,2),i=a[0],s=a[1],l=0,c=0;if(o&&o!==document.body){var u=o.getBoundingClientRect();l=u.x+i,c=u.y+s}var p,d=t.getBoundingClientRect(),f=d.width,h=d.height,y=d.x;return{width:f,height:h,top:d.y+s-c,left:y+i-l}}function unSplitWords(t){get(t).isWord?(remove(t),t.replaceWith.apply(t,_toConsumableArray(t.childNodes))):toArray(t.children).forEach(function(t){return unSplitWords(t)})}var createFragment=function t(){return document.createDocumentFragment()};function repositionAfterSplit(t,e,r){var n,o,a,i=parseTypes(e.types),s=e.tagName,l=t.getElementsByTagName(""),c=[],u=[],p=null,d=[],f=t.parentElement,h=t.nextElementSibling,y=createFragment(),g=window.getComputedStyle(t),m=g.textAlign,b=.2*parseFloat(g.fontSize);return e.absolute&&(a={left:t.offsetLeft,top:t.offsetTop,width:t.offsetWidth},o=t.offsetWidth,n=t.offsetHeight,set(t,{cssWidth:t.style.width,cssHeight:t.style.height})),toArray(l).forEach(function(n){var o=n.parentElement===t,a=getPosition(n,o,e,r),s=a.width,l=a.height,d=a.top,f=a.left;!/^br$/i.test(n.nodeName)&&(i.lines&&o&&((null===p||d-p>=b)&&(p=d,c.push(u=[])),u.push(n)),e.absolute&&set(n,{top:d,left:f,width:s,height:l}))}),f&&f.removeChild(t),i.lines&&(d=c.map(function(t){var r=createElement(s,{class:"".concat(e.splitClass," ").concat(e.lineClass),style:"display: block; text-align: ".concat(m,"; width: 100%;")});set(r,"isLine",!0);var n={height:0,top:1e4};return y.appendChild(r),t.forEach(function(t,e,o){var a=get(t),i=a.isWordEnd,s=a.top,l=a.height,c=o[e+1];n.height=Math.max(n.height,l),n.top=Math.min(n.top,s),r.appendChild(t),i&&get(c).isWordStart&&r.append(" ")}),e.absolute&&set(r,{height:n.height,top:n.top}),r}),i.words||unSplitWords(y),t.replaceChildren(y)),e.absolute&&(t.style.width="".concat(t.style.width||o,"px"),t.style.height="".concat(n,"px"),toArray(l).forEach(function(t){var e=get(t),r=e.isLine,n=e.top,o=e.left,i=e.width,s=e.height,l=get(t.parentElement),c=!r&&l.isLine;t.style.top="".concat(c?n-l.top:n,"px"),t.style.left=r?"".concat(a.left,"px"):"".concat(o-(c?a.left:0),"px"),t.style.height="".concat(s,"px"),t.style.width=r?"".concat(a.width,"px"):"".concat(i,"px"),t.style.position="absolute"})),f&&(h?f.insertBefore(t,h):f.appendChild(t)),d}var _defaults=extend(defaults,{}),SplitType=function(){function t(e,r){_classCallCheck(this,t),this.isSplit=!1,this.settings=extend(_defaults,parseSettings(r)),this.elements=getTargetElements(e),this.split()}return _createClass(t,null,[{key:"clearData",value:function t(){clear()}},{key:"setDefaults",value:function t(e){return _defaults=extend(_defaults,parseSettings(e)),defaults}},{key:"revert",value:function t(e){getTargetElements(e).forEach(function(t){var e=get(t),r=e.isSplit,n=e.html,o=e.cssWidth,a=e.cssHeight;r&&(t.innerHTML=n,t.style.width=o||"",t.style.height=a||"",remove(t))})}},{key:"create",value:function e(r,n){return new t(r,n)}},{key:"data",get:function t(){return cache}},{key:"defaults",get:function t(){return _defaults},set:function t(e){_defaults=extend(_defaults,parseSettings(e))}}]),_createClass(t,[{key:"split",value:function t(e){var r=this;this.revert(),this.elements.forEach(function(t){set(t,"html",t.innerHTML)}),this.lines=[],this.words=[],this.chars=[];var n=[window.pageXOffset,window.pageYOffset];void 0!==e&&(this.settings=extend(this.settings,parseSettings(e)));var o=parseTypes(this.settings.types);!o.none&&(this.elements.forEach(function(t){set(t,"isRoot",!0);var e=split(t,r.settings),n=e.words,o=e.chars;r.words=[].concat(_toConsumableArray(r.words),_toConsumableArray(n)),r.chars=[].concat(_toConsumableArray(r.chars),_toConsumableArray(o))}),this.elements.forEach(function(t){if(o.lines||r.settings.absolute){var e=repositionAfterSplit(t,r.settings,n);r.lines=[].concat(_toConsumableArray(r.lines),_toConsumableArray(e))}}),this.isSplit=!0,window.scrollTo(n[0],n[1]),cleanup())}},{key:"revert",value:function e(){this.isSplit&&(this.lines=null,this.words=null,this.chars=null,this.isSplit=!1),t.revert(this.elements)}}]),t}();export{SplitType as default};